# 宅配便取扱量の状態空間モデルによる分析

月次の宅配便取扱量データに対して、トレンド・季節性・外的要因を含む状態空間モデルを構築し、長期的な変化や一時的なショックの影響を分析しています。

---

## フォルダ構成


---

## 使用ツール・ライブラリ

- Python（JupyterLab）
- pandas, matplotlib, seaborn
- statsmodels（状態空間モデル）

---

## 分析目的

- 長期トレンドと季節性の分離
- 外的ショック（リーマンショック、消費税増税、コロナ禍など）の定量化
- 将来予測のための構造的な理解の促進

---

## モデル構成

- トレンド：ローカル線形トレンド（レベル + 傾き）
- 季節性：周期12の季節成分
- 外的要因：ショック・制度変更などを外生ダミーとして導入

---

## 外的要因の実装方針

| 要因               | タイプ             | 実装例（外生変数）              | 実装の考え方                                                    |
| ---------------- | --------------- | ---------------------- | --------------------------------------------------------- |
| リーマンショック（2008年秋） | 突発的・一時的（構造ブレイク） | `shock_dummy`              | `shock_dummy = 1` from 2008年9月〜数ヶ月間、それ以外は0                |
| 消費税増税（2014年4月など） | 予告あり・段階的（+駆け込み） | `tax_increase`, `rush_dummy` | 増税後は `tax_increase = 1`、直前3ヶ月などは `rush_dummy = 1`         |
| 配送料値上げ           | 永続的影響           | `delivery_price_up`          | 値上げ以降 `delivery_price_up = 1`                                   |
| コロナ禍             | 段階的・長期          | `covid`                       | 2020年春以降 `covid = 1`。時変係数や累積的傾向で補正も検討可能             |

---

## TODO

- [x] トレンド・季節性モデルの構築
- [x] 外生変数の設計と導入（上記ダミー）
- [x] フィッティングと平滑化
- [ ] モデル予測精度の検証（MSEなど）
- [ ] ***外生変数の導入***
- [ ] ***ハイパラの探索(グリッドサーチ、optuna)***

---

## 出力例（Jupyter/Plotly）

- トレンド・季節性・残差の可視化
- 外生変数の効果（shock_effect など）の信頼区間つきプロット
- 今後数ヶ月の予測

---

## データについて

- 観測期間：2000年1月〜現在（毎月）
- 単位：宅配便取扱量（万個）

---

## 連絡・著者

- 作成者: Fuga Terashima
- 所属 Higuchi ML LAB
- 使用目的（研究/業務 など）
